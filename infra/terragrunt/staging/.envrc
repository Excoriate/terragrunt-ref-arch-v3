#!/usr/bin/env bash
# Staging Environment Configuration
#
# This file provides a flexible configuration point for staging-specific
# environment variables. It inherits from parent configurations and allows
# for environment-specific customizations.
#
# CUSTOMIZATION GUIDE:
# 1. Uncomment and modify the variables below to suit your staging needs
# 2. Add new variables following the _safe_export pattern
# 3. Override global variables or add staging-specific configurations
# 4. Use _display_exported_vars to see current environment setup

# Ensure PROJECT_ROOT is set with defensive path resolution
PROJECT_ROOT="${PROJECT_ROOT:-$(cd "$(dirname "${BASH_SOURCE[0]}")/../.." && pwd)}"
export PROJECT_ROOT

# Source parent .envrc with error handling
# shellcheck disable=SC1091
source_up || {
    # Log error if parent sourcing fails, but continue script execution
    echo >&2 "Warning: Could not source parent .envrc"
}

# Robust utility script sourcing with explicit path resolution
# Ensure absolute path and quote the source
# shellcheck source=/dev/null
source "${PROJECT_ROOT}/scripts/envrc-utils.sh"

# Staging Environment Variables
# Uncomment and modify these variables as needed:
_safe_export STAGING_ENVIRONMENT_TYPE "pre-production"
# _safe_export STAGING_RESOURCE_LIMITS "moderate"
# _safe_export AWS_PROFILE "staging"
# _safe_export TG_INSTANCE_TYPE "t3.medium"
# _safe_export TG_MAX_CAPACITY "4"
# _safe_export TG_MIN_CAPACITY "1"
# _safe_export TG_ENABLE_ENHANCED_MONITORING "true"

# Display exported variables (optional)
_display_exported_vars "STAGING_"
